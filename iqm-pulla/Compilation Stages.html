
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Compilation Stages &#8212; IQM Pulla 8.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=82f04c04"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Compilation Stages';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Custom Gates and Gate Implementations" href="Custom%20Gates%20and%20Implementations.html" />
    <link rel="prev" title="Configuration and Usage" href="Configuration%20and%20Usage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="8.1.0" />
    <meta name="docbuild:last-update" content="2025-07-02"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="IQM Pulla 8.1.0 documentation - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="IQM Pulla 8.1.0 documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="readme.html">IQM Pulla</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration_guide.html">Migration guide</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="user_guides.html">User guides</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Quick%20Start.html">Quick Start</a></li>



<li class="toctree-l2"><a class="reference internal" href="Configuration%20and%20Usage.html">Configuration and Usage</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Compilation Stages</a></li>
<li class="toctree-l2"><a class="reference internal" href="Custom%20Gates%20and%20Implementations.html">Custom Gates and Gate Implementations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples.html">Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Example%20-%20Measuring%20T1.html">Example: Measuring T1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example%20-%20Simple%20Dynamical%20Decoupling.html">Example: Dynamical decoupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example%20-%20Executing%20QIR%20programs.html">Executing QIR programs</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="API.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/iqm.cpc.html">iqm.cpc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.cpc.compiler.html">iqm.cpc.compiler</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.compiler.circuit_compilation_request_handler.html">iqm.cpc.compiler.circuit_compilation_request_handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.compiler.compiler.html">iqm.cpc.compiler.compiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.compiler.dd.html">iqm.cpc.compiler.dd</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.compiler.errors.html">iqm.cpc.compiler.errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.compiler.standard_stages.html">iqm.cpc.compiler.standard_stages</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.compiler.station_settings.html">iqm.cpc.compiler.station_settings</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.cpc.interface.html">iqm.cpc.interface</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.cpc.interface.compiler.html">iqm.cpc.interface.compiler</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/iqm.pulla.html">iqm.pulla</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.calibration.html">iqm.pulla.calibration</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.calibration.CalibrationDataProvider.html">iqm.pulla.calibration.CalibrationDataProvider</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.interface.html">iqm.pulla.interface</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.CircuitMeasurementResults.html">iqm.pulla.interface.CircuitMeasurementResults</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.CircuitMeasurementResultsBatch.html">iqm.pulla.interface.CircuitMeasurementResultsBatch</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.BUFFER_AFTER_MEASUREMENT_PROBE.html">iqm.pulla.interface.BUFFER_AFTER_MEASUREMENT_PROBE</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.Circuit.html">iqm.pulla.interface.Circuit</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.Instruction.html">iqm.pulla.interface.Instruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.StationControlResult.html">iqm.pulla.interface.StationControlResult</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.TaskStatus.html">iqm.pulla.interface.TaskStatus</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.CHADRetrievalException.html">iqm.pulla.interface.CHADRetrievalException</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.ChipLabelRetrievalException.html">iqm.pulla.interface.ChipLabelRetrievalException</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.interface.SettingsRetrievalException.html">iqm.pulla.interface.SettingsRetrievalException</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.pulla.html">iqm.pulla.pulla</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.pulla.Pulla.html">iqm.pulla.pulla.Pulla</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.quantum_architecture.html">iqm.pulla.quantum_architecture</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.quantum_architecture.create_dynamic_quantum_architecture.html">iqm.pulla.quantum_architecture.create_dynamic_quantum_architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.quantum_architecture.create_static_quantum_architecture.html">iqm.pulla.quantum_architecture.create_static_quantum_architecture</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.utils.html">iqm.pulla.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.InstructionLocation.html">iqm.pulla.utils.InstructionLocation</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.build_settings.html">iqm.pulla.utils.build_settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.calset_from_observations.html">iqm.pulla.utils.calset_from_observations</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.calset_to_cal_data_tree.html">iqm.pulla.utils.calset_to_cal_data_tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.circuit_operations_to_cpc.html">iqm.pulla.utils.circuit_operations_to_cpc</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.convert_sweep_spot.html">iqm.pulla.utils.convert_sweep_spot</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.convert_sweep_spot_with_heralding_mode_zero.html">iqm.pulla.utils.convert_sweep_spot_with_heralding_mode_zero</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.extract_readout_controller_result_names.html">iqm.pulla.utils.extract_readout_controller_result_names</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.find_circuit_boundary.html">iqm.pulla.utils.find_circuit_boundary</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.get_hash_for.html">iqm.pulla.utils.get_hash_for</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.initialize_schedule_builder.html">iqm.pulla.utils.initialize_schedule_builder</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.iqm_circuit_to_gate_implementation.html">iqm.pulla.utils.iqm_circuit_to_gate_implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.locate_instructions.html">iqm.pulla.utils.locate_instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.map_qubit_indices.html">iqm.pulla.utils.map_qubit_indices</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.map_sweep_results_to_logical_qubits.html">iqm.pulla.utils.map_sweep_results_to_logical_qubits</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.print_channel.html">iqm.pulla.utils.print_channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.print_schedule.html">iqm.pulla.utils.print_schedule</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.replace_instruction_in_place.html">iqm.pulla.utils.replace_instruction_in_place</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils.InstructionLocation.html">iqm.pulla.utils.InstructionLocation</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.utils_cirq.html">iqm.pulla.utils_cirq</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_cirq.cirq_to_cpc.html">iqm.pulla.utils_cirq.cirq_to_cpc</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.utils_dd.html">iqm.pulla.utils_dd</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_dd.generate_phases_of_urn_sequence.html">iqm.pulla.utils_dd.generate_phases_of_urn_sequence</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.utils_qir.html">iqm.pulla.utils_qir</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_qir.qir_to_pulla.html">iqm.pulla.utils_qir.qir_to_pulla</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="api/iqm.pulla.utils_qiskit.html">iqm.pulla.utils_qiskit</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_qiskit.qiskit_circuits_to_pulla.html">iqm.pulla.utils_qiskit.qiskit_circuits_to_pulla</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_qiskit.qiskit_to_pulla.html">iqm.pulla.utils_qiskit.qiskit_to_pulla</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_qiskit.station_control_result_to_qiskit.html">iqm.pulla.utils_qiskit.station_control_result_to_qiskit</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_qiskit.DummyJob.html">iqm.pulla.utils_qiskit.DummyJob</a></li>
<li class="toctree-l4"><a class="reference internal" href="api/iqm.pulla.utils_qiskit.IQMPullaBackend.html">iqm.pulla.utils_qiskit.IQMPullaBackend</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="common_errors.html">Common errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Compilation Stages.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Compilation Stages</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-compilation-stage">Custom compilation stage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-stages">Standard stages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#st-standard-stage-circuit-level-passes">1st standard stage: circuit-level passes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nd-standard-stage-circuit-resolution">2nd standard stage: circuit resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rd-standard-stage-timebox-level-passes">3rd standard stage: timebox-level passes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-timebox-resolution">4th standard stage: timebox resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-dynamical-decoupling">5th standard stage: dynamical decoupling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-schedule-level-passes">6th standard stage: schedule-level passes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-schedule-resolution">7th standard stage: schedule resolution</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="compilation-stages">
<h1>Compilation Stages<a class="headerlink" href="#compilation-stages" title="Link to this heading">#</a></h1>
<section id="custom-compilation-stage">
<h2>Custom compilation stage<a class="headerlink" href="#custom-compilation-stage" title="Link to this heading">#</a></h2>
<p>The generic lifecycle of a Pulla job is a one-way multi-step transformation. The states are as follow:</p>
<ol class="arabic simple">
<li><p>Quantum Circuit in a specific format (e.g. Qiskit, Cirq)</p></li>
<li><p>Equivalent Quantum Circuit in an IQM Pulse format (list of CircuitOperations)</p></li>
<li><p>IQM Pulse nested Timebox representation</p></li>
<li><p>IQM Pulse Schedule representation</p></li>
<li><p>Measurement results</p></li>
</ol>
<p>You don’t have to start with a circuit, you can define quantum operations directly (roughly starting from state 2), or define pulse shapes directly (roughly starting from state 3 or 4). The compilation which produces states 3 and 4 is itself multi-step: it consists of multiple stages, and each stage of one or more passes.</p>
<p>Let’s go over the generic use case, starting from creating a Qiskit circuit to work on:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">visualization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.compiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">transpile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">iqm.qiskit_iqm</span><span class="w"> </span><span class="kn">import</span> <span class="n">IQMProvider</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">iqm.qiskit_iqm.iqm_transpilation</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize_single_qubit_gates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">iqm.pulla.pulla</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pulla</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">iqm.pulla.utils_qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">station_control_result_to_qiskit</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cocos_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PULLA_COCOS_URL&#39;</span><span class="p">]</span>  <span class="c1"># or set the URL directly here</span>
<span class="n">station_control_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PULLA_STATION_CONTROL_URL&#39;</span><span class="p">]</span>  <span class="c1"># or set the URL directly here</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">IQMProvider</span><span class="p">(</span><span class="n">cocos_url</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">get_backend</span><span class="p">()</span>

<span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">qc</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>

<span class="c1"># Transpile, route and optimize the circuit</span>
<span class="n">qc_transpiled</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">layout_method</span><span class="o">=</span><span class="s1">&#39;sabre&#39;</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc_optimized</span> <span class="o">=</span> <span class="n">optimize_single_qubit_gates</span><span class="p">(</span><span class="n">qc_transpiled</span><span class="p">)</span>

<span class="c1"># Print the circuit</span>
<span class="n">qc_optimized</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;mpl&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;clifford&quot;</span><span class="p">,</span> <span class="n">idle_wires</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3188e6f1c870c23a413f6b8e13631efd1f3099082e27a4053c799447ea6f538f.png" src="_images/3188e6f1c870c23a413f6b8e13631efd1f3099082e27a4053c799447ea6f538f.png" />
</div>
</div>
<p>Pulla has utility functions which accept circuits in different formats (Qiskit, Cirq, IQM JSON) and convert them into Pulla/IQM Pulse format, which is a list of <code class="docutils literal notranslate"><span class="pre">CircuitOperation</span></code> objects. Let’s do that. Note that none of the operations have an implementation specified (<code class="docutils literal notranslate"><span class="pre">implementation=None</span></code>).</p>
<p>The Qiskit conversion utility also gives us a standard compiler with the same calibration set as the one used by <code class="docutils literal notranslate"><span class="pre">backend</span></code>, in this case the current default one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">iqm.pulla.utils_qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">qiskit_to_pulla</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">Pulla</span><span class="p">(</span><span class="n">station_control_url</span><span class="p">)</span>
<span class="n">circuits</span><span class="p">,</span> <span class="n">compiler</span> <span class="o">=</span> <span class="n">qiskit_to_pulla</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">qc_optimized</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">circuits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11-26 14:02:08;W] station-control-client version &#39;1.23&#39; is newer minor version than &#39;1.18&#39; used by the station control server, some new client features might not be supported.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Circuit(name=&#39;circuit-166&#39;,
        instructions=(CircuitOperation(name=&#39;prx&#39;,
                                       locus=(&#39;0&#39;,),
                                       args={&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 0.75},
                                       implementation=None),
                      CircuitOperation(name=&#39;prx&#39;,
                                       locus=(&#39;2&#39;,),
                                       args={&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 0.75},
                                       implementation=None),
                      CircuitOperation(name=&#39;cz&#39;,
                                       locus=(&#39;2&#39;, &#39;0&#39;),
                                       args={},
                                       implementation=None),
                      CircuitOperation(name=&#39;prx&#39;,
                                       locus=(&#39;0&#39;,),
                                       args={&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.25},
                                       implementation=None),
                      CircuitOperation(name=&#39;prx&#39;,
                                       locus=(&#39;4&#39;,),
                                       args={&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 0.75},
                                       implementation=None),
                      CircuitOperation(name=&#39;cz&#39;,
                                       locus=(&#39;2&#39;, &#39;4&#39;),
                                       args={},
                                       implementation=None),
                      CircuitOperation(name=&#39;prx&#39;,
                                       locus=(&#39;4&#39;,),
                                       args={&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.25},
                                       implementation=None),
                      CircuitOperation(name=&#39;barrier&#39;,
                                       locus=(&#39;2&#39;, &#39;0&#39;, &#39;4&#39;),
                                       args={},
                                       implementation=None),
                      CircuitOperation(name=&#39;measure&#39;,
                                       locus=(&#39;2&#39;,),
                                       args={&#39;key&#39;: &#39;meas_3_1_0&#39;},
                                       implementation=None),
                      CircuitOperation(name=&#39;measure&#39;,
                                       locus=(&#39;0&#39;,),
                                       args={&#39;key&#39;: &#39;meas_3_1_1&#39;},
                                       implementation=None),
                      CircuitOperation(name=&#39;measure&#39;,
                                       locus=(&#39;4&#39;,),
                                       args={&#39;key&#39;: &#39;meas_3_1_2&#39;},
                                       implementation=None)))
</pre></div>
</div>
</div>
</div>
<p>In order to understand how the compilation stages work, let’s remove the standard stages from the compiler:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compiler</span><span class="o">.</span><span class="n">stages</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p>You can check the readiness of the compiler by calling <code class="docutils literal notranslate"><span class="pre">compiler.ready()</span></code>. Right now it would return <code class="docutils literal notranslate"><span class="pre">False</span></code> due to empty stages list.</p>
<p>The compiler flow consists of one or more stages, and each stage consists of one or more passes. When the compiler is initialized created by Pulla, it is pre-populated with standard stages.</p>
<p>You can define your own stages, with your own passes, grouping them in some meaningful way. Each pass is a function which accepts two arguments: data and context. Data is an iterable of objects of an applicable data type, and context is a dictionary of any additional information. Each pass can transform the data and modify the context, and must return both data and context. This convention allows the compiler to pipe arbitrary amount of passes.</p>
<p>A stage is just an ordered collection of passes. The compiler has methods <code class="docutils literal notranslate"><span class="pre">run_stage()</span></code> and <code class="docutils literal notranslate"><span class="pre">run_pass()</span></code> allowing you to run particular stages or passes. The <code class="docutils literal notranslate"><span class="pre">compile()</span></code> method is just calling <code class="docutils literal notranslate"><span class="pre">run_stage()</span></code> in correct order and passes its initial context to the first pass of the first stage.</p>
<p>Let’s write a simple compilation stage to illustrate the concept:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">iqm.cpc.compiler.compiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">CompilationStage</span>

<span class="n">my_stage</span> <span class="o">=</span> <span class="n">CompilationStage</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_stage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s write two simple passes for that stage. For the first: perhaps we want to add a leading barrier to each circuit.
<code class="docutils literal notranslate"><span class="pre">add_leading_barrier</span></code> below determines the locations of qubits used in the circuit and adds a barrier on those qubits as the first instruction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">iqm.cpc.interface.compiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">CircuitOperation</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_leading_barrier</span><span class="p">(</span><span class="n">circuits</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add leading barrier on all used qubits.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">circuit</span> <span class="ow">in</span> <span class="n">circuits</span><span class="p">:</span>
        <span class="n">loci</span> <span class="o">=</span> <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">locus</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">circuit</span><span class="o">.</span><span class="n">instructions</span><span class="p">]</span>
        <span class="n">loci</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">loci</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sub</span><span class="p">]</span>
        <span class="n">loci</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">loci</span><span class="p">))</span>
        <span class="n">new_barrier</span> <span class="o">=</span> <span class="n">CircuitOperation</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;barrier&#39;</span><span class="p">,</span> <span class="n">locus</span><span class="o">=</span><span class="n">loci</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">{},</span> <span class="n">implementation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">instructions</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_barrier</span><span class="p">,)</span> <span class="o">+</span> <span class="n">circuit</span><span class="o">.</span><span class="n">instructions</span>
    <span class="k">return</span> <span class="n">circuits</span><span class="p">,</span> <span class="n">context</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the function takes data and context and returns data and context. It happens to neither use nor modify the context, but it should still provide it down to the next passes.</p>
<p>Ok, let’s define another pass: this one would increase the phase of each <code class="docutils literal notranslate"><span class="pre">prx</span></code> operation by <code class="docutils literal notranslate"><span class="pre">0.25</span></code>. This may or may
not make practical sense, but bear with us for the purposes of illustration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">increase_phase</span><span class="p">(</span><span class="n">circuits</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add 0.25 to phase_t of each prx gate.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">circuit</span> <span class="ow">in</span> <span class="n">circuits</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instruction</span> <span class="ow">in</span> <span class="n">circuit</span><span class="o">.</span><span class="n">instructions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">instruction</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;prx&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
                <span class="n">instruction</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;phase_t&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.25</span>
    <span class="k">return</span> <span class="n">circuits</span><span class="p">,</span> <span class="n">context</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s add those two passes to our stage, then replace the empty <code class="docutils literal notranslate"><span class="pre">stages</span></code> property of the compiler with a list consisting of our single stage, and then call <code class="docutils literal notranslate"><span class="pre">show_stages()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_stage</span><span class="o">.</span><span class="n">add_passes</span><span class="p">(</span><span class="n">add_leading_barrier</span><span class="p">,</span> <span class="n">increase_phase</span><span class="p">)</span>
<span class="n">compiler</span><span class="o">.</span><span class="n">stages</span> <span class="o">=</span> <span class="p">[</span><span class="n">my_stage</span><span class="p">]</span>

<span class="n">compiler</span><span class="o">.</span><span class="n">show_stages</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stage 0: my_stage
    0: add_leading_barrier
        Add leading barrier on all used qubits.
    1: increase_phase
        Add 0.25 to phase_t of each prx gate.
</pre></div>
</div>
</div>
</div>
<p>The boolean flag <code class="docutils literal notranslate"><span class="pre">full</span></code> of <code class="docutils literal notranslate"><span class="pre">show_stages()</span></code> is optional; when <code class="docutils literal notranslate"><span class="pre">True</span></code>, the doc strings of each pass are printed on the screen.</p>
<p>Now that the compiler is ready and we can run <code class="docutils literal notranslate"><span class="pre">compile</span></code>. The compiler always operates on batches of circuits, so you need to provide an iterable; in our case, it’s a list with a single circuit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">circuits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 0.75}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 0.75}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.25}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 0.75}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.25}
</pre></div>
</div>
</div>
</div>
<p>Note that it did not really compile the circuits into pulse schedules, because the only passes we’ve defined only modify the circuits, but don’t perform the conversion to pulse schedules. The compilation to pulse schedules usually consists of converting circuits to <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es, then resolving <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es into a single <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>, then resolving it into a <code class="docutils literal notranslate"><span class="pre">Schedule</span></code>, and finally converting a <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> into a final <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> ready to be submitted to the server.</p>
<p>There might be cases when your compilation stages need additional data. You can provide such data as a custom context dictionary. Get the initial compiler context and modify it, then pass it when calling <code class="docutils literal notranslate"><span class="pre">compile</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compiler_context</span><span class="p">()</span>
<span class="n">context</span><span class="p">[</span><span class="s2">&quot;some_extra_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">data</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">circuits</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.0}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.0}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.5}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.0}
{&#39;angle_t&#39;: 0.25, &#39;phase_t&#39;: 1.5}
</pre></div>
</div>
</div>
</div>
</section>
<section id="standard-stages">
<h2>Standard stages<a class="headerlink" href="#standard-stages" title="Link to this heading">#</a></h2>
<p>As mentioned earlier, Pulla comes with a pre-defined “standard” set of stages which you can use and, if needed, modify. These standard stages are used by CoCoS if you were to submit a circuit to CoCoS (without using Pulla). Thus, if you use the same version of the Pulla library that the remote CoCoS uses, you will be able to produce and inspect the same pulse schedules that CoCoS would (assuming you use the same calibration set).</p>
<p>Let’s replace our current single stage with standard stages, and view them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">iqm.cpc.compiler.standard_stages</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_standard_stages</span>

<span class="n">compiler</span><span class="o">.</span><span class="n">stages</span> <span class="o">=</span> <span class="n">get_standard_stages</span><span class="p">()</span>
<span class="n">compiler</span><span class="o">.</span><span class="n">show_stages</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stage 0: circuit
    0: validate_circuits_move_gate
    1: map_old_operations
    2: map_implementations_for_loci
    3: derive_readout_mappings


Stage 1: circuit_resolution
    0: resolve_circuits


Stage 2: timebox
    0: multiplex_readout
    1: prepend_heralding
    2: prepend_reset


Stage 3: timebox_resolution
    0: resolve_timeboxes


Stage 4: dynamical_decoupling
    0: apply_dd_strategy


Stage 5: schedule
    0: apply_move_gate_phase_corrections
    1: clean_schedule


Stage 6: schedule_resolution
    0: build_playlist
</pre></div>
</div>
</div>
</div>
<p>There are 7 standard stages:</p>
<ol class="arabic simple">
<li><p>circuit-level: takes care of validating the circuit, renaming some deprecated names, gathering
information for the next stages</p></li>
<li><p>circuit resolution: converts circuits to <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es</p></li>
<li><p>timebox-level: optimizes “measure” gates by multiplexing them if possible</p></li>
<li><p>timebox resolution: converts <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es to <code class="docutils literal notranslate"><span class="pre">Schedule</span></code></p></li>
<li><p>schedule-level: applies dynamical decoupling</p></li>
<li><p>schedule-level: potentially applies some corrections, then cleans up the schedules</p></li>
<li><p>schedule resolution: converts <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> to the final Playlist ready to be executed</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuits</span><span class="p">,</span> <span class="n">compiler</span> <span class="o">=</span> <span class="n">qiskit_to_pulla</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">qc_optimized</span><span class="p">)</span>
<span class="n">data</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">circuits</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Variable <code class="docutils literal notranslate"><span class="pre">data</span></code> now contains the Playlist in its final form, and <code class="docutils literal notranslate"><span class="pre">context</span></code> contains a dictionary of various things
which were either necessary in some of the passes, or will be necessary for the final execution. It also contains a
copy of  <code class="docutils literal notranslate"><span class="pre">schedules</span></code> from before the final playlist resolution. Some of those pieces of data will be needed to build
Station  Control settings (more on that later).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final playlist:&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Context fields:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final playlist:
Playlist(channel_descriptions={&#39;PL-1__readout&#39;: ChannelDescription(channel_config=ReadoutChannelConfig(sampling_rate=2000000000),
                                                                   controller_name=&#39;PL-1__readout&#39;),
                               &#39;QB1__drive.awg&#39;: ChannelDescription(channel_config=IQChannelConfig(sampling_rate=2000000000),
                                                                    controller_name=&#39;QB1__drive.awg&#39;),
                               &#39;QB3__drive.awg&#39;: ChannelDescription(channel_config=IQChannelConfig(sampling_rate=2000000000),
                                                                    controller_name=&#39;QB3__drive.awg&#39;),
                               &#39;QB5__drive.awg&#39;: ChannelDescription(channel_config=IQChannelConfig(sampling_rate=2000000000),
                                                                    controller_name=&#39;QB5__drive.awg&#39;),
                               &#39;TC-1-3__flux.awg&#39;: ChannelDescription(channel_config=RealChannelConfig(sampling_rate=2000000000),
                                                                      controller_name=&#39;TC-1-3__flux.awg&#39;),
                               &#39;TC-3-5__flux.awg&#39;: ChannelDescription(channel_config=RealChannelConfig(sampling_rate=2000000000),
                                                                      controller_name=&#39;TC-3-5__flux.awg&#39;)},
         segments=[Segment(instructions={&#39;PL-1__readout&#39;: [0, 7],
                                         &#39;QB1__drive.awg&#39;: [0, 1, 2, 3],
                                         &#39;QB3__drive.awg&#39;: [0, 1, 2, 3],
                                         &#39;QB5__drive.awg&#39;: [0, 1, 2, 3, 4],
                                         &#39;TC-1-3__flux.awg&#39;: [0, 1, 2],
                                         &#39;TC-3-5__flux.awg&#39;: [0, 1, 2]})])
Context fields:
[&#39;calibration_set&#39;, &#39;builder&#39;, &#39;component_mapping&#39;, &#39;options&#39;, &#39;channel_properties&#39;, &#39;chip_topology&#39;, &#39;circuit_metrics&#39;, &#39;readout_mappings&#39;, &#39;heralded_components&#39;, &#39;schedules&#39;]
</pre></div>
</div>
</div>
</div>
<p>Instead of calling <code class="docutils literal notranslate"><span class="pre">compile()</span></code>, which runs all the stages, you can run each stage, or even each separate pass, by yourself. In that case you will have to take care of two things:</p>
<ol class="arabic simple">
<li><p>Provide initial context to the first pass of the first stage.</p></li>
<li><p>Save data and context returned by each pass (or stage) in order to provide it to the next pass (or stage).</p></li>
</ol>
<p>To help you with 1, the compiler has a method <code class="docutils literal notranslate"><span class="pre">compiler_context()</span></code> which returns a dictionary of initial context.</p>
<p>(Note: to run a pass of any particular stage: <code class="docutils literal notranslate"><span class="pre">compiler.stages[0].passes[0](data,</span> <span class="pre">context)</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compiler</span><span class="o">.</span><span class="n">compiler_context</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;calibration_set&#39;, &#39;builder&#39;, &#39;component_mapping&#39;, &#39;options&#39;, &#39;channel_properties&#39;, &#39;chip_topology&#39;])
</pre></div>
</div>
</div>
</div>
<p>Let’s create another circuit and compile it manually. We’ll use this example to understand each standard stage:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qc2</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">qc2</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>

<span class="n">qc2_transpiled</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc2</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">layout_method</span><span class="o">=</span><span class="s1">&#39;sabre&#39;</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qc2_optimized</span> <span class="o">=</span> <span class="n">optimize_single_qubit_gates</span><span class="p">(</span><span class="n">qc2_transpiled</span><span class="p">)</span>
<span class="n">circuits2</span><span class="p">,</span> <span class="n">compiler</span> <span class="o">=</span> <span class="n">qiskit_to_pulla</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">qc2_optimized</span><span class="p">)</span>

<span class="c1"># Initial context (from the compiler) and data (list of circuits)</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compiler_context</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">circuits2</span>
</pre></div>
</div>
</div>
</div>
<section id="st-standard-stage-circuit-level-passes">
<h3>1st standard stage: circuit-level passes<a class="headerlink" href="#st-standard-stage-circuit-level-passes" title="Link to this heading">#</a></h3>
<p>The first stage is circuit-level passes:</p>
<ul class="simple">
<li><p>When defining a circuit in IQM JSON or IQM Pulse format directly, you can specify an implementation for each gate (selecting from implementations provided by the calibration set). If no implementation is specified, the standard circuit-level stage will select the default implementation for each gate automatically.</p></li>
<li><p>Currently, the choice of the default implementation is global: e.g. <code class="docutils literal notranslate"><span class="pre">prx</span></code> may have <code class="docutils literal notranslate"><span class="pre">drag_gaussian</span></code> as the default. In the future, the calibration may yield different implementations for different loci, striving to provide the best quality.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_circuits</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">processed_circuits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Circuit(name=&#39;circuit-175&#39;,
         instructions=(CircuitOperation(name=&#39;prx&#39;,
                                        locus=(&#39;QB2&#39;,),
                                        args={&#39;angle&#39;: 1.5707963267948966,
                                              &#39;phase&#39;: 4.71238898038469},
                                        implementation=&#39;drag_crf&#39;),
                       CircuitOperation(name=&#39;prx&#39;,
                                        locus=(&#39;QB3&#39;,),
                                        args={&#39;angle&#39;: 1.5707963267948966,
                                              &#39;phase&#39;: 4.71238898038469},
                                        implementation=&#39;drag_crf&#39;),
                       CircuitOperation(name=&#39;prx&#39;,
                                        locus=(&#39;QB5&#39;,),
                                        args={&#39;angle&#39;: 1.5707963267948966,
                                              &#39;phase&#39;: 4.71238898038469},
                                        implementation=&#39;drag_crf&#39;),
                       CircuitOperation(name=&#39;cz&#39;,
                                        locus=(&#39;QB3&#39;, &#39;QB5&#39;),
                                        args={},
                                        implementation=&#39;crf&#39;),
                       CircuitOperation(name=&#39;cz&#39;,
                                        locus=(&#39;QB2&#39;, &#39;QB3&#39;),
                                        args={},
                                        implementation=&#39;crf&#39;),
                       CircuitOperation(name=&#39;prx&#39;,
                                        locus=(&#39;QB2&#39;,),
                                        args={&#39;angle&#39;: 1.5707963267948966,
                                              &#39;phase&#39;: 7.853981633974483},
                                        implementation=&#39;drag_crf&#39;),
                       CircuitOperation(name=&#39;prx&#39;,
                                        locus=(&#39;QB5&#39;,),
                                        args={&#39;angle&#39;: 1.5707963267948966,
                                              &#39;phase&#39;: 7.853981633974483},
                                        implementation=&#39;drag_crf&#39;),
                       CircuitOperation(name=&#39;barrier&#39;,
                                        locus=(&#39;QB3&#39;, &#39;QB5&#39;, &#39;QB2&#39;),
                                        args={},
                                        implementation=&#39;&#39;),
                       CircuitOperation(name=&#39;measure&#39;,
                                        locus=(&#39;QB3&#39;,),
                                        args={&#39;key&#39;: &#39;meas_3_1_0&#39;},
                                        implementation=&#39;constant&#39;),
                       CircuitOperation(name=&#39;measure&#39;,
                                        locus=(&#39;QB5&#39;,),
                                        args={&#39;key&#39;: &#39;meas_3_1_1&#39;},
                                        implementation=&#39;constant&#39;),
                       CircuitOperation(name=&#39;measure&#39;,
                                        locus=(&#39;QB2&#39;,),
                                        args={&#39;key&#39;: &#39;meas_3_1_2&#39;},
                                        implementation=&#39;constant&#39;),
                       CircuitOperation(name=&#39;measure&#39;,
                                        locus=(&#39;QB4&#39;, &#39;QB1&#39;),
                                        args={&#39;key&#39;: &#39;__MEASUREMENT_MODE&#39;},
                                        implementation=None)))]
</pre></div>
</div>
</div>
</div>
</section>
<section id="nd-standard-stage-circuit-resolution">
<h3>2nd standard stage: circuit resolution<a class="headerlink" href="#nd-standard-stage-circuit-resolution" title="Link to this heading">#</a></h3>
<p>Now we can convert the circuit to <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es. <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> is a concept of IQM Pulse: a container for one or more instruction schedule fragments, to be scheduled according to a given scheduling strategy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeboxes</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">processed_circuits</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

<span class="c1"># let&#39;s look into the first TimeBox which corresponds to the PRX instruction on QB1</span>
<span class="n">timeboxes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>:           circuit-175
[0]:        PRX_DRAGCosineRiseFall on (&#39;QB2&#39;,) (atomic)
[1]:        PRX_DRAGCosineRiseFall on (&#39;QB3&#39;,) (atomic)
[2]:        PRX_DRAGCosineRiseFall on (&#39;QB5&#39;,) (atomic)
[3]:        CZ_CRF on (&#39;QB3&#39;, &#39;QB5&#39;) (atomic)
[4]:        CZ_CRF on (&#39;QB2&#39;, &#39;QB3&#39;) (atomic)
[5]:        PRX_DRAGCosineRiseFall on (&#39;QB2&#39;,) (atomic)
[6]:        PRX_DRAGCosineRiseFall on (&#39;QB5&#39;,) (atomic)
[7]:        Barrier on (&#39;QB3&#39;, &#39;QB5&#39;, &#39;QB2&#39;) (atomic)
[8]:        Readout on (&#39;QB3&#39;,)
[8][0]:     Measure_Constant on (&#39;QB3&#39;,) (atomic)
[9]:        Readout on (&#39;QB5&#39;,)
[9][0]:     Measure_Constant on (&#39;QB5&#39;,) (atomic)
[10]:       Readout on (&#39;QB2&#39;,)
[10][0]:    Measure_Constant on (&#39;QB2&#39;,) (atomic)
[11]:       Readout on (&#39;QB4&#39;, &#39;QB1&#39;)
[11][0]:    MultiplexedProbeTimeBox on {&#39;QB4&#39;, &#39;QB1&#39;} (atomic)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">timeboxes</span></code> is a list of <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> objects, and you can edit them manually. A <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> can contain multiple children <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es, each containing either more <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es or a <code class="docutils literal notranslate"><span class="pre">Schedule</span></code>. A <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> containing a <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> rather than children is referred to as “atomic”. In our example here the circuit was converted into one <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> containing 11 children atomic <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es, which correspond to 11 circuit operations (7 gates + 1 barrier gate + 3 measurement gates). An atomic <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> holds its <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> in an <code class="docutils literal notranslate"><span class="pre">atom</span></code> property:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeboxes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;QB2__drive.awg    1:!=|\n&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="rd-standard-stage-timebox-level-passes">
<h3>3rd standard stage: timebox-level passes<a class="headerlink" href="#rd-standard-stage-timebox-level-passes" title="Link to this heading">#</a></h3>
<p>Next is a timebox-level stage, which only has one pass: multiplexing measurements. The <code class="docutils literal notranslate"><span class="pre">measure_all()</span></code> we called when
creating the circuit adds a single <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> with the gate implementation <code class="docutils literal notranslate"><span class="pre">Measure_Constant</span></code> for each qubit in the
circuit.
With the <code class="docutils literal notranslate"><span class="pre">measurement_mode='all'</span></code> option, the first stage has also added a measurement <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code> for the unused qubits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeboxes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>:           circuit-175
[0]:        PRX_DRAGCosineRiseFall on (&#39;QB2&#39;,) (atomic)
[1]:        PRX_DRAGCosineRiseFall on (&#39;QB3&#39;,) (atomic)
[2]:        PRX_DRAGCosineRiseFall on (&#39;QB5&#39;,) (atomic)
[3]:        CZ_CRF on (&#39;QB3&#39;, &#39;QB5&#39;) (atomic)
[4]:        CZ_CRF on (&#39;QB2&#39;, &#39;QB3&#39;) (atomic)
[5]:        PRX_DRAGCosineRiseFall on (&#39;QB2&#39;,) (atomic)
[6]:        PRX_DRAGCosineRiseFall on (&#39;QB5&#39;,) (atomic)
[7]:        Barrier on (&#39;QB3&#39;, &#39;QB5&#39;, &#39;QB2&#39;) (atomic)
[8]:        Readout on (&#39;QB3&#39;,)
[8][0]:     Measure_Constant on (&#39;QB3&#39;,) (atomic)
[9]:        Readout on (&#39;QB5&#39;,)
[9][0]:     Measure_Constant on (&#39;QB5&#39;,) (atomic)
[10]:       Readout on (&#39;QB2&#39;,)
[10][0]:    Measure_Constant on (&#39;QB2&#39;,) (atomic)
[11]:       Readout on (&#39;QB4&#39;, &#39;QB1&#39;)
[11][0]:    MultiplexedProbeTimeBox on {&#39;QB4&#39;, &#39;QB1&#39;} (atomic)
</pre></div>
</div>
</div>
</div>
<p>Multiplexing means executing all of these measurements at once, instead of one after the other.
The multiplexing pass does this optimization for us:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiplexed_timeboxes</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">timeboxes</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="n">multiplexed_timeboxes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>:           circuit-175
[0]:        PRX_DRAGCosineRiseFall on (&#39;QB2&#39;,) (atomic)
[1]:        PRX_DRAGCosineRiseFall on (&#39;QB3&#39;,) (atomic)
[2]:        PRX_DRAGCosineRiseFall on (&#39;QB5&#39;,) (atomic)
[3]:        CZ_CRF on (&#39;QB3&#39;, &#39;QB5&#39;) (atomic)
[4]:        CZ_CRF on (&#39;QB2&#39;, &#39;QB3&#39;) (atomic)
[5]:        PRX_DRAGCosineRiseFall on (&#39;QB2&#39;,) (atomic)
[6]:        PRX_DRAGCosineRiseFall on (&#39;QB5&#39;,) (atomic)
[7]:        Barrier on (&#39;QB3&#39;, &#39;QB5&#39;, &#39;QB2&#39;) (atomic)
[8]:        MultiplexedProbeTimeBox on {&#39;QB2&#39;, &#39;QB5&#39;, &#39;QB4&#39;, &#39;QB3&#39;, &#39;QB1&#39;} (atomic)
</pre></div>
</div>
</div>
</div>
<p>If you construct a circuit in Qiskit, and want to ensure multiplexing of measurement instructions, you have to “wrap” a group of measurement instructions with <code class="docutils literal notranslate"><span class="pre">barrier</span></code>s. This would prevent the Qiskit transpiler from putting any other instructions, acting on the same qubits, in between measurements, thus allowing the compiler to multiplex.</p>
</section>
<section id="th-standard-stage-timebox-resolution">
<h3>4th standard stage: timebox resolution<a class="headerlink" href="#th-standard-stage-timebox-resolution" title="Link to this heading">#</a></h3>
<p>Next we convert <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es into a single <code class="docutils literal notranslate"><span class="pre">Schedule</span></code>. This is a recursive process which resolves all nested <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es into atomic <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es, and finally assembles a single <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> out each of batches of <code class="docutils literal notranslate"><span class="pre">TimeBox</span></code>es. At this stage, all relative timings between pulses are resolved and fixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">schedules</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">multiplexed_timeboxes</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="n">schedules</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_contents</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;QB2__drive.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687afe7ad0&gt;,
 &#39;QB3__drive.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae1f750&gt;,
 &#39;QB5__drive.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae1c390&gt;,
 &#39;TC-3-5__flux.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae1f850&gt;,
 &#39;TC-2-3__flux.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae1ee90&gt;,
 &#39;QB3__flux.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae691d0&gt;,
 &#39;PL-1__readout&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae69490&gt;,
 &#39;QB4__drive.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae69210&gt;,
 &#39;QB1__drive.awg&#39;: &lt;iqm.pulse.playlist.schedule.Segment at 0x1687ae6b2d0&gt;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="th-standard-stage-dynamical-decoupling">
<h3>5th standard stage: dynamical decoupling<a class="headerlink" href="#th-standard-stage-dynamical-decoupling" title="Link to this heading">#</a></h3>
<p>Dynamical decoupling pulse sequences get inserted to replace <code class="docutils literal notranslate"><span class="pre">Wait</span></code> instructions. The process is controlled by a user-submitted dynamical decoupling strategy. By default, this stage is disabled. Please see other notebooks for examples of how to enable and apply dynamical decoupling.</p>
</section>
<section id="th-standard-stage-schedule-level-passes">
<h3>6th standard stage: schedule-level passes<a class="headerlink" href="#th-standard-stage-schedule-level-passes" title="Link to this heading">#</a></h3>
<p>Next is a schedule-level stage. Its first pass applies calibrated phase corrections if MOVE gates are used (only applicable to QCs with computational resonator, i.e. IQM Star Architecture). The second pass removes non-functional instructions from the schedules.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_schedules</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">schedules</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="th-standard-stage-schedule-resolution">
<h3>7th standard stage: schedule resolution<a class="headerlink" href="#th-standard-stage-schedule-resolution" title="Link to this heading">#</a></h3>
<p>Finally, the last stage builds a final schedule from a number of instruction schedules. A playlist is just a compressed <code class="docutils literal notranslate"><span class="pre">Schedule</span></code> with no duplicate information, ready to be submitted for execution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">playlist</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">processed_schedules</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Schedule info:
 - 6 channels
 - 1 segments
 - 9 unique waveforms
 - 27 unique instructions

 QB2__drive.awg:
    Instruction(duration_samples=40, operation=IQPulse(wave_i=CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0), wave_q=Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ])), scale_i=0.04456917758598103, scale_q=-0.003974513897077347, phase=-1.5707963267948966, modulation_frequency=0.0, phase_increment=0))
    Instruction(duration_samples=112, operation=Wait())
    Instruction(duration_samples=88, operation=VirtualRZ(phase_increment=-3.8499027575510922))
    Instruction(duration_samples=40, operation=IQPulse(wave_i=CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0), wave_q=Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ])), scale_i=0.04456917758598103, scale_q=-0.003974513897077347, phase=1.5707963267948966, modulation_frequency=0.0, phase_increment=0))
    Instruction(duration_samples=2144, operation=Wait())

    CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0)
    Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ]))

 QB3__drive.awg:
    Instruction(duration_samples=40, operation=IQPulse(wave_i=CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0), wave_q=Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ])), scale_i=0.05189384885411283, scale_q=-0.005331421370612681, phase=-1.5707963267948966, modulation_frequency=0.0, phase_increment=0))
    Instruction(duration_samples=112, operation=VirtualRZ(phase_increment=-4.837426979072975))
    Instruction(duration_samples=88, operation=VirtualRZ(phase_increment=-5.05990505679636))
    Instruction(duration_samples=2184, operation=Wait())

    CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0)
    Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ]))

 QB5__drive.awg:
    Instruction(duration_samples=40, operation=IQPulse(wave_i=CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0), wave_q=Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ])), scale_i=0.04971671718199658, scale_q=-0.0046665883752283555, phase=-1.5707963267948966, modulation_frequency=0.0, phase_increment=0))
    Instruction(duration_samples=112, operation=VirtualRZ(phase_increment=-4.141444572356641))
    Instruction(duration_samples=40, operation=IQPulse(wave_i=CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0), wave_q=Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ])), scale_i=0.04971671718199658, scale_q=-0.0046665883752283555, phase=1.5707963267948966, modulation_frequency=0.0, phase_increment=0))
    Instruction(duration_samples=2232, operation=Wait())

    CosineRiseFall(n_samples=40, full_width=1.0, rise_time=0.5, center_offset=0.0)
    Samples(n_samples=40, samples=array([ 0.0784591 ,  0.23344536,  0.38268343,  0.52249856,  0.64944805,
        0.76040597,  0.85264016,  0.92387953,  0.97236992,  0.99691733,
        0.99691733,  0.97236992,  0.92387953,  0.85264016,  0.76040597,
        0.64944805,  0.52249856,  0.38268343,  0.23344536,  0.0784591 ,
       -0.0784591 , -0.23344536, -0.38268343, -0.52249856, -0.64944805,
       -0.76040597, -0.85264016, -0.92387953, -0.97236992, -0.99691733,
       -0.99691733, -0.97236992, -0.92387953, -0.85264016, -0.76040597,
       -0.64944805, -0.52249856, -0.38268343, -0.23344536, -0.0784591 ]))

 TC-3-5__flux.awg:
    Instruction(duration_samples=40, operation=Wait())
    Instruction(duration_samples=112, operation=RealPulse(wave=CosineRiseFall(n_samples=112, full_width=0.8032845266041941, rise_time=0.17857142857142855, center_offset=0.0), scale=0.024448583113667537))
    Instruction(duration_samples=2272, operation=Wait())

    CosineRiseFall(n_samples=112, full_width=0.8032845266041941, rise_time=0.17857142857142855, center_offset=0.0)

 TC-2-3__flux.awg:
    Instruction(duration_samples=152, operation=Wait())
    Instruction(duration_samples=88, operation=RealPulse(wave=CosineRiseFall(n_samples=88, full_width=0.7546642325137667, rise_time=0.22727272727272727, center_offset=0.0), scale=0.03114217780591079))
    Instruction(duration_samples=2184, operation=Wait())

    CosineRiseFall(n_samples=88, full_width=0.7546642325137667, rise_time=0.22727272727272727, center_offset=0.0)

 PL-1__readout:
    Instruction(duration_samples=280, operation=Wait())
    Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.08941176470588236, scale_q=0.0, phase=-0.587976442473868, modulation_frequency=0.035762280701749805, phase_increment=0.0))
    Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.07352941176470588, scale_q=0.0, phase=-1.0463919227242826, modulation_frequency=-0.1299149122807064, phase_increment=0.0))
    Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.08941176470588236, scale_q=0.0, phase=-0.6153040444477949, modulation_frequency=-0.28011315789474156, phase_increment=0.0))
    Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.1, scale_q=0.0, phase=0.9632997125655525, modulation_frequency=-0.042427192982460976, phase_increment=0.0))
    Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.06823529411764706, scale_q=0.0, phase=-0.6231643821475537, modulation_frequency=-0.1860201754386015, phase_increment=0.0))
    Instruction(duration_samples=1032, operation=MultiplexedIQPulse(entries=((Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.08941176470588236, scale_q=0.0, phase=-0.587976442473868, modulation_frequency=0.035762280701749805, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.07352941176470588, scale_q=0.0, phase=-1.0463919227242826, modulation_frequency=-0.1299149122807064, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.08941176470588236, scale_q=0.0, phase=-0.6153040444477949, modulation_frequency=-0.28011315789474156, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.1, scale_q=0.0, phase=0.9632997125655525, modulation_frequency=-0.042427192982460976, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.06823529411764706, scale_q=0.0, phase=-0.6231643821475537, modulation_frequency=-0.1860201754386015, phase_increment=0.0)), 32))))
    Instruction(duration_samples=2144, operation=ReadoutTrigger(probe_pulse=Instruction(duration_samples=1032, operation=MultiplexedIQPulse(entries=((Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.08941176470588236, scale_q=0.0, phase=-0.587976442473868, modulation_frequency=0.035762280701749805, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.07352941176470588, scale_q=0.0, phase=-1.0463919227242826, modulation_frequency=-0.1299149122807064, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.08941176470588236, scale_q=0.0, phase=-0.6153040444477949, modulation_frequency=-0.28011315789474156, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.1, scale_q=0.0, phase=0.9632997125655525, modulation_frequency=-0.042427192982460976, phase_increment=0.0)), 32), (Instruction(duration_samples=1000, operation=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=0.06823529411764706, scale_q=0.0, phase=-0.6231643821475537, modulation_frequency=-0.1860201754386015, phase_increment=0.0)), 32)))), acquisitions=(ThresholdStateDiscrimination(label=&#39;QB3__meas_3_1_0&#39;, delay_samples=992, weights=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=1.0, scale_q=0.0, phase=0.0, modulation_frequency=0.035762280701749805, phase_increment=0.0), threshold=0.0025793458599823065, feedback_signal_label=&#39;&#39;), ThresholdStateDiscrimination(label=&#39;QB5__meas_3_1_1&#39;, delay_samples=992, weights=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=1.0, scale_q=0.0, phase=0.0, modulation_frequency=-0.1299149122807064, phase_increment=0.0), threshold=0.0038544742606811573, feedback_signal_label=&#39;&#39;), ThresholdStateDiscrimination(label=&#39;QB2__meas_3_1_2&#39;, delay_samples=992, weights=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=1.0, scale_q=0.0, phase=0.0, modulation_frequency=-0.28011315789474156, phase_increment=0.0), threshold=0.0007528833634885235, feedback_signal_label=&#39;&#39;), ThresholdStateDiscrimination(label=&#39;QB4____MEASUREMENT_MODE&#39;, delay_samples=992, weights=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=1.0, scale_q=0.0, phase=0.0, modulation_frequency=-0.042427192982460976, phase_increment=0.0), threshold=0.005798437128413735, feedback_signal_label=&#39;&#39;), ThresholdStateDiscrimination(label=&#39;QB1____MEASUREMENT_MODE&#39;, delay_samples=992, weights=IQPulse(wave_i=Constant(n_samples=1000), wave_q=Constant(n_samples=1000), scale_i=1.0, scale_q=0.0, phase=0.0, modulation_frequency=-0.1860201754386015, phase_increment=0.0), threshold=0.0021365335467484503, feedback_signal_label=&#39;&#39;))))

    Constant(n_samples=1000)
</pre></div>
</div>
</div>
</div>
<p>In order to submit this final schedule for execution, we have to do one more thing: build the Station Control settings. The settings control the behaviour of instruments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">settings</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">build_settings</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>At this point everything is ready to be submitted for execution to the server. Namely, these three objects will be used to construct a request to Station Control Service:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">playlist</span></code>: sequence of instruction schedules corresponding to the batch of circuits to be executed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">settings</span></code>: Station Control settings node</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">context['readout_mappings']</span></code>: a mapping from measurement keys to the names of readout controller acquisition labels that will hold the measurement results</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response_data</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[11-26 14:02:12;I] Submitted sweep with ID: 9e4ec691-33f0-4187-941a-0e2f5282dcf8
[11-26 14:02:12;I] Created task in queue with ID: cd4c4082-a9f0-4aa6-8b12-006a1075a19c
[11-26 14:02:12;I] Sweep link: http://xld11-s2.xld11.iqm.fi/station/sweeps/9e4ec691-33f0-4187-941a-0e2f5282dcf8
[11-26 14:02:12;I] Task link: http://xld11-s2.xld11.iqm.fi/station/tasks/cd4c4082-a9f0-4aa6-8b12-006a1075a19c
[11-26 14:02:12;I] Waiting for the sweep to finish...
[11-26 14:02:13;I] Sweep status: SweepStatus.SUCCESS
[11-26 14:02:14;I] [{&#39;meas_3_1_2&#39;: [[1.0], [1.0], [1.0], [1.0], [0.0], [0.0], [1.0], [1.0], [1.0], [0.0], [0.0], [1.0], [1.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0], [1.0]], &#39;meas_3_1_1&#39;: [[1.0], [1.0], [1.0], [1.0], [0.0], [0.0], [1.0], [1.0], [1.0], [1.0], [1.0], [1.0], [1.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0], [1.0]], &#39;meas_3_1_0&#39;: [[1.0], [1.0], [1.0], [1.0], [0.0], [0.0], [1.0], [1.0], [1.0], [1.0], [1.0], [1.0], [1.0], [0.0], [1.0], [0.0], [0.0], [0.0], [1.0], [1.0]]}]
</pre></div>
</div>
</div>
</div>
<p>Now we can convert these raw results into a Qiskit <code class="docutils literal notranslate"><span class="pre">Result</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qiskit_result</span> <span class="o">=</span> <span class="n">station_control_result_to_qiskit</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">execution_options</span><span class="o">=</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Qiskit result counts: </span><span class="si">{</span><span class="n">qiskit_result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">visualization</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">qiskit_result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Qiskit result counts: {&#39;111&#39;: 12, &#39;000&#39;: 6, &#39;011&#39;: 2}
</pre></div>
</div>
<img alt="_images/227ed90b94773711b73815c09be2af2bc6db8cb6abb42b120c6ca837815dd551.png" src="_images/227ed90b94773711b73815c09be2af2bc6db8cb6abb42b120c6ca837815dd551.png" />
</div>
</div>
<p>We can also submit the same circuit to CoCoS for execution. CoCoS is essentially a server-side Pulla with fixed standard stages. Since we started with a normal Qiskit backend and a circuit, execution is as simple as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">job</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qc_optimized</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>
<span class="n">visualization</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;111&#39;: 8, &#39;000&#39;: 7, &#39;101&#39;: 2, &#39;011&#39;: 1, &#39;001&#39;: 2}
</pre></div>
</div>
<img alt="_images/e32f681e5a54249a782c93db93966b2598fbac86f0a1bc0d901705ce25426f29.png" src="_images/e32f681e5a54249a782c93db93966b2598fbac86f0a1bc0d901705ce25426f29.png" />
</div>
</div>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Configuration%20and%20Usage.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Configuration and Usage</p>
      </div>
    </a>
    <a class="right-next"
       href="Custom%20Gates%20and%20Implementations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Custom Gates and Gate Implementations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-compilation-stage">Custom compilation stage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-stages">Standard stages</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#st-standard-stage-circuit-level-passes">1st standard stage: circuit-level passes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nd-standard-stage-circuit-resolution">2nd standard stage: circuit resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rd-standard-stage-timebox-level-passes">3rd standard stage: timebox-level passes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-timebox-resolution">4th standard stage: timebox resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-dynamical-decoupling">5th standard stage: dynamical decoupling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-schedule-level-passes">6th standard stage: schedule-level passes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#th-standard-stage-schedule-resolution">7th standard stage: schedule resolution</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By IQM Pulla developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024-2025, IQM Finland Oy, Release 8.1.0.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 2025-07-02.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>